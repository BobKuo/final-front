import{r as c,c as g,z as y,m as n,B as o,a2 as Q,q as h,f as t,l as p,F as x,A as V,u,a4 as m,Q as f}from"./index-DuVc2JOo.js";import{Q as L,a as k,b as q}from"./QTable-BGCuviHb.js";import{Q as B}from"./QToolbar-CXmJrt-0.js";import{Q as C}from"./QPage-DRkzm7hi.js";import{o as P}from"./order-Dly09Wku.js";import"./QList-BNQ8w0KT.js";import"./rtl-DFPa-2ov.js";import"./QMenu-zUqIhfnm.js";import"./selection-GgRsZ4Kw.js";import"./QItemLabel-XNKP8KDl.js";import"./format-BvkBI9bc.js";import"./use-fullscreen-DMlLm8e_.js";const A={style:{"overflow-x":"auto","max-width":"100%"}},H={__name:"OrdersPage",setup(O){const v=Q(),i=c([]),b=[{name:"orderid",label:"訂單編號",field:"_id"},{name:"createdAt",label:"建立日期",field:e=>new Date(e.createdAt).toLocaleString(),sortable:!0},{name:"cartobj",label:"商品",field:"cart",sortable:!1},{name:"totalPrice",label:"總金額",field:e=>e.cart.reduce((r,a)=>r+a.product.price*a.quantity,0)}];(async()=>{try{const{data:e}=await P.getMy();i.value=e.result}catch(e){console.error("Error fetching orders:",e),v.notify({type:"negative",message:"無法載入訂單資料"})}})();const l=c(""),s=c(""),w=g(()=>i.value.filter(e=>{const r=!l.value||e._id.toLowerCase().includes(l.value.toLowerCase()),a=!s.value||e.createdAt.toLowerCase().includes(s.value.toLowerCase());return r&&a}));return(e,r)=>(n(),y(C,{class:"flex flex-center"},{default:o(()=>[h("div",A,[t(L,{separator:"cell",rows:w.value,columns:b,"row-key":"_id",class:"q-table--dense",pagination:{rowsPerPage:10}},{top:o(()=>[t(B,null,{default:o(()=>[t(m,{modelValue:l.value,"onUpdate:modelValue":r[0]||(r[0]=a=>l.value=a),dense:"",outlined:"",clearable:"",placeholder:"搜尋訂單編號"},{prepend:o(()=>[t(f,{name:"search"})]),_:1},8,["modelValue"]),t(q),t(m,{modelValue:s.value,"onUpdate:modelValue":r[1]||(r[1]=a=>s.value=a),dense:"",outlined:"",clearable:"",placeholder:"搜尋建立日期"},{prepend:o(()=>[t(f,{name:"search"})]),_:1},8,["modelValue"])]),_:1})]),"body-cell-cartobj":o(a=>[t(k,{props:a,style:{width:"300px"}},{default:o(()=>[(n(!0),p(x,null,V(a.row.cart,(d,_)=>(n(),p("div",{key:_},u(d.product.name)+" ("+u(d.quantity)+") - $"+u(d.product.price),1))),128))]),_:2},1032,["props"])]),_:1},8,["rows"])])]),_:1}))}};export{H as default};
