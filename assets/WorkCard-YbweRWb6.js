import{Q as me}from"./QChip-BsDxS4OK.js";import{P as pe,aC as L,aD as he,aE as ve,aF as ye,g as we,r as Q,c as b,V as be,W as ke,aG as je,aH as Se,aI as Te,w as z,H as F,aJ as U,aK as G,aL as Ce,h as J,aM as _e,Z as xe,M as Pe,a3 as Ee,a2 as Oe,l as K,m as H,q as a,f,B as u,aw as Ie,F as Z,A as Me,z as qe,a8 as T,u as C,a7 as B,ax as X,x as De,aN as Le,a4 as _}from"./index-B461q1Ze.js";import{v as He,a as Y,u as Be,p as ee,b as Ae,c as Qe,d as Ve,r as te,s as We}from"./position-engine-ChCOnJ3m.js";import{c as oe}from"./selection-BYe2XIGp.js";import{g as ae}from"./index-CH_iu5NA.js";import{_ as $e}from"./_plugin-vue_export-helper-DlAUqK2U.js";const A=pe({name:"QTooltip",inheritAttrs:!1,props:{...Be,...ye,...L,maxHeight:{type:String,default:null},maxWidth:{type:String,default:null},transitionShow:{...L.transitionShow,default:"jump-down"},transitionHide:{...L.transitionHide,default:"jump-up"},anchor:{type:String,default:"bottom middle",validator:Y},self:{type:String,default:"top middle",validator:Y},offset:{type:Array,default:()=>[14,14],validator:He},scrollTarget:ve,delay:{type:Number,default:0},hideDelay:{type:Number,default:0},persistent:Boolean},emits:[...he],setup(e,{slots:r,emit:i,attrs:s}){let d,m;const y=we(),{proxy:{$q:l}}=y,p=Q(null),w=Q(!1),x=b(()=>ee(e.anchor,l.lang.rtl)),P=b(()=>ee(e.self,l.lang.rtl)),E=b(()=>e.persistent!==!0),{registerTick:k,removeTick:O}=be(),{registerTimeout:h}=ke(),{transitionProps:I,transitionStyle:o}=je(e),{localScrollTarget:t,changeScrollEvent:c,unconfigureScrollTarget:M}=Ae(e,N),{anchorEl:g,canShow:ie,anchorEvents:j}=Qe({showing:w,configureAnchorEl:de}),{show:se,hide:q}=Se({showing:w,canShow:ie,handleShow:re,handleHide:le,hideOnRouteChange:E,processOnMount:!0});Object.assign(j,{delayShow:ce,delayHide:ue});const{showPortal:V,hidePortal:W,renderPortal:ne}=Te(y,p,ge,"tooltip");if(l.platform.is.mobile===!0){const n={anchorEl:g,innerRef:p,onClickOutside(v){return q(v),v.target.classList.contains("q-dialog__backdrop")&&Pe(v),!0}},D=b(()=>e.modelValue===null&&e.persistent!==!0&&w.value===!0);z(D,v=>{(v===!0?Ve:te)(n)}),F(()=>{te(n)})}function re(n){V(),k(()=>{m=new MutationObserver(()=>S()),m.observe(p.value,{attributes:!1,childList:!0,characterData:!0,subtree:!0}),S(),N()}),d===void 0&&(d=z(()=>l.screen.width+"|"+l.screen.height+"|"+e.self+"|"+e.anchor+"|"+l.lang.rtl,S)),h(()=>{V(!0),i("show",n)},e.transitionDuration)}function le(n){O(),W(),$(),h(()=>{W(!0),i("hide",n)},e.transitionDuration)}function $(){m!==void 0&&(m.disconnect(),m=void 0),d!==void 0&&(d(),d=void 0),M(),U(j,"tooltipTemp")}function S(){We({targetEl:p.value,offset:e.offset,anchorEl:g.value,anchorOrigin:x.value,selfOrigin:P.value,maxHeight:e.maxHeight,maxWidth:e.maxWidth})}function ce(n){if(l.platform.is.mobile===!0){oe(),document.body.classList.add("non-selectable");const D=g.value,v=["touchmove","touchcancel","touchend","click"].map(R=>[D,R,"delayHide","passiveCapture"]);G(j,"tooltipTemp",v)}h(()=>{se(n)},e.delay)}function ue(n){l.platform.is.mobile===!0&&(U(j,"tooltipTemp"),oe(),setTimeout(()=>{document.body.classList.remove("non-selectable")},10)),h(()=>{q(n)},e.hideDelay)}function de(){if(e.noParentEvent===!0||g.value===null)return;const n=l.platform.is.mobile===!0?[[g.value,"touchstart","delayShow","passive"]]:[[g.value,"mouseenter","delayShow","passive"],[g.value,"mouseleave","delayHide","passive"]];G(j,"anchor",n)}function N(){if(g.value!==null||e.scrollTarget!==void 0){t.value=Ce(g.value,e.scrollTarget);const n=e.noParentEvent===!0?S:q;c(t.value,n)}}function fe(){return w.value===!0?J("div",{...s,ref:p,class:["q-tooltip q-tooltip--style q-position-engine no-pointer-events",s.class],style:[s.style,o.value],role:"tooltip"},xe(r.default)):null}function ge(){return J(_e,I.value,fe)}return F($),Object.assign(y.proxy,{updatePosition:S}),ne}}),Ne={class:"project-image"},Re=["src","alt"],ze={class:"row full-width items-center"},Fe={class:"col"},Ue={class:"row justify-end q-gutter-xs"},Ge={class:"col-4"},Je={class:"row justify-end"},Ke={class:"project-content"},Ze={class:"project-category"},Xe={class:"project-title"},Ye={class:"project-description"},et=["src","alt"],tt={__name:"WorkCard",props:{project:{type:Object,required:!0,validator:e=>e&&typeof e=="object"&&"id"in e&&"title"in e&&"category"in e&&"description"in e&&"image"in e},isReverse:{type:Boolean,default:!1}},setup(e){const r=Ee(),i=Oe(),s=e,d=Q(!1),m=()=>{d.value=!0},y=()=>{d.value=!1},l=async()=>{const o=`${window.location.origin}${window.location.pathname}#/work#project-${s.project.id}`;try{p(o)}catch(t){t.name!=="AbortError"&&(console.error("分享失敗:",t),p(o))}},p=o=>{x("copy",o)},w=async o=>{try{if(navigator.clipboard&&window.isSecureContext)return await navigator.clipboard.writeText(o),!0;throw new Error("複製功能不受支援")}catch(t){return console.error("複製失敗:",t),!1}},x=async(o,t)=>{switch(o){case"copy":{await w(t)?r.notify({type:"positive",message:"連結已複製到剪貼簿！",position:"top",timeout:2e3,icon:"content_copy"}):r.dialog({title:"手動複製連結",message:"請手動複製以下連結：",prompt:{model:t,type:"text",readonly:!0},ok:"關閉",persistent:!0});break}case"facebook":window.open(`https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(t)}`,"_blank","width=600,height=400,scrollbars=yes,resizable=yes"),r.notify({type:"info",message:"正在開啟 Facebook 分享...",position:"top",timeout:2e3,icon:"facebook"});break;case"line":window.open(`https://social-plugins.line.me/lineit/share?url=${encodeURIComponent(t)}`,"_blank","width=600,height=400,scrollbars=yes,resizable=yes"),r.notify({type:"info",message:"正在開啟 LINE 分享...",position:"top",timeout:2e3,icon:"chat"});break;default:r.notify({type:"negative",message:"未知的分享方式",position:"top",timeout:2e3})}},P=o=>{const c=o.currentTarget.querySelector(".project-content");ae.to(c,{y:-10,duration:.3})},E=o=>{const c=o.currentTarget.querySelector(".project-content");ae.to(c,{y:0,duration:.3})},k=b(()=>!i.isLoggedIn||!i.favorites?!1:i.favorites.includes(s.project.id)),O=async()=>{if(!i.isLoggedIn){r.dialog({title:"需要登入",message:"請先登入帳號才能加入收藏"});return}try{k.value?(await _.favorites({work:s.project.id,action:"remove"}),i.favorites=i.favorites.filter(o=>o!==s.project.id),r.notify({type:"info",message:"已移除收藏",icon:"favorite_border",position:"top",timeout:2e3})):(await _.favorites({work:s.project.id,action:"add"}),i.favorites.push(s.project.id),r.notify({type:"positive",message:"已加入收藏",icon:"favorite",position:"top",timeout:2e3}))}catch(o){console.error("收藏操作失敗:",o),r.notify({type:"negative",message:k.value?"無法移除收藏":"無法加入收藏",position:"top",timeout:2e3})}},h=b(()=>!i.isLoggedIn||!i.goods?!1:i.goods.includes(s.project.id)),I=async()=>{if(!i.isLoggedIn){r.dialog({title:"需要登入",message:"請先登入帳號才能加入按讚"});return}try{h.value?(await _.goods({work:s.project.id,action:"remove"}),i.goods=i.goods.filter(o=>o!==s.project.id)):(await _.goods({work:s.project.id,action:"add"}),i.goods.push(s.project.id))}catch(o){console.error("按讚操作失敗:",o),r.notify({type:"negative",message:h.value?"無法移除按讚":"無法加入按讚",position:"top",timeout:2e3})}};return(o,t)=>(H(),K(Z,null,[a("div",{class:De(["project-item bg-judy-1",{reverse:e.isReverse}]),onMouseenter:P,onMouseleave:E},[a("div",Ne,[f(X,{class:"my-card",flat:"",bordered:""},{default:u(()=>[a("img",{src:e.project.image,alt:e.project.title,class:"main-image",onClick:m},null,8,Re),f(Ie,{align:e.isReverse?"left":"right"},{default:u(()=>[a("div",ze,[a("div",Fe,[a("div",Ue,[(H(!0),K(Z,null,Me(e.project.tags,(c,M)=>(H(),qe(me,{square:"",color:`judy-${2+M%5}`,"text-color":"white",icon:"tag",key:c},{default:u(()=>[T(C(c),1)]),_:2},1032,["color"]))),128))])]),a("div",Ge,[a("div",Je,[f(B,{flat:"",round:"",color:"red",icon:h.value?"favorite":"favorite_border",onClick:I},{default:u(()=>[f(A,null,{default:u(()=>t[1]||(t[1]=[T("喜歡按讚",-1)])),_:1,__:[1]})]),_:1},8,["icon"]),f(B,{flat:"",round:"",color:"teal",icon:k.value?"bookmark":"bookmark_border",onClick:O},{default:u(()=>[f(A,null,{default:u(()=>t[2]||(t[2]=[T("加入書籤",-1)])),_:1,__:[2]})]),_:1},8,["icon"]),f(B,{flat:"",round:"",color:"primary",icon:"share",onClick:l},{default:u(()=>[f(A,null,{default:u(()=>t[3]||(t[3]=[T("分享作品",-1)])),_:1,__:[3]})]),_:1})])])])]),_:1},8,["align"])]),_:1})]),a("div",Ke,[a("div",Ze,"－"+C(e.project.category),1),a("h3",Xe,C(e.project.title),1),a("p",Ye,C(e.project.description),1),a("button",{class:"project-link",onClick:m},t[4]||(t[4]=[a("span",null,"放大看作品",-1),a("svg",{class:"arrow-icon",viewBox:"0 0 24 24"},[a("path",{d:"M5 12h14M12 5l7 7-7 7"})],-1)]))])],34),f(Le,{modelValue:d.value,"onUpdate:modelValue":t[0]||(t[0]=c=>d.value=c),maximized:"","transition-show":"none","transition-hide":"none"},{default:u(()=>[f(X,{class:"image-dialog-card bg-black"},{default:u(()=>[a("div",{class:"image-container",onClick:y},[a("img",{src:e.project.image,alt:e.project.title,class:"fullsize-image",onClick:y},null,8,et)])]),_:1})]),_:1},8,["modelValue"])],64))}},lt=$e(tt,[["__scopeId","data-v-ecfb15ff"]]);export{lt as W};
