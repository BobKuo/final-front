import{Q as ge}from"./QChip-CBhllH3Y.js";import{P as pe,aC as q,aD as he,aE as ve,aF as ye,g as we,r as B,c as j,V as be,W as ke,aG as je,aH as Se,aI as Te,w as $,H as N,aJ as R,aK as z,aL as Ce,h as F,aM as _e,Z as xe,M as Pe,a3 as Ee,a2 as Oe,l as U,m as D,q as a,f,B as l,aw as Me,F as G,A as qe,z as De,a8 as T,u as C,a7 as H,ax as J,x as He,aN as Ie,a4 as K}from"./index-CWWtOGS4.js";import{v as Be,a as Z,u as Le,p as X,b as Ae,c as Qe,d as Ve,r as Y,s as We}from"./position-engine-Cm4IBZQC.js";import{c as ee}from"./selection-RagBi1Fd.js";import{g as te}from"./index-CH_iu5NA.js";import{_ as $e}from"./_plugin-vue_export-helper-DlAUqK2U.js";const I=pe({name:"QTooltip",inheritAttrs:!1,props:{...Le,...ye,...q,maxHeight:{type:String,default:null},maxWidth:{type:String,default:null},transitionShow:{...q.transitionShow,default:"jump-down"},transitionHide:{...q.transitionHide,default:"jump-up"},anchor:{type:String,default:"bottom middle",validator:Z},self:{type:String,default:"top middle",validator:Z},offset:{type:Array,default:()=>[14,14],validator:Be},scrollTarget:ve,delay:{type:Number,default:0},hideDelay:{type:Number,default:0},persistent:Boolean},emits:[...he],setup(e,{slots:s,emit:c,attrs:u}){let d,g;const v=we(),{proxy:{$q:n}}=v,p=B(null),y=B(!1),_=j(()=>X(e.anchor,n.lang.rtl)),x=j(()=>X(e.self,n.lang.rtl)),P=j(()=>e.persistent!==!0),{registerTick:w,removeTick:E}=be(),{registerTimeout:o}=ke(),{transitionProps:t,transitionStyle:r}=je(e),{localScrollTarget:S,changeScrollEvent:oe,unconfigureScrollTarget:ae}=Ae(e,V),{anchorEl:m,canShow:ie,anchorEvents:b}=Qe({showing:y,configureAnchorEl:de}),{show:se,hide:O}=Se({showing:y,canShow:ie,handleShow:re,handleHide:le,hideOnRouteChange:P,processOnMount:!0});Object.assign(b,{delayShow:ce,delayHide:ue});const{showPortal:L,hidePortal:A,renderPortal:ne}=Te(v,p,me,"tooltip");if(n.platform.is.mobile===!0){const i={anchorEl:m,innerRef:p,onClickOutside(h){return O(h),h.target.classList.contains("q-dialog__backdrop")&&Pe(h),!0}},M=j(()=>e.modelValue===null&&e.persistent!==!0&&y.value===!0);$(M,h=>{(h===!0?Ve:Y)(i)}),N(()=>{Y(i)})}function re(i){L(),w(()=>{g=new MutationObserver(()=>k()),g.observe(p.value,{attributes:!1,childList:!0,characterData:!0,subtree:!0}),k(),V()}),d===void 0&&(d=$(()=>n.screen.width+"|"+n.screen.height+"|"+e.self+"|"+e.anchor+"|"+n.lang.rtl,k)),o(()=>{L(!0),c("show",i)},e.transitionDuration)}function le(i){E(),A(),Q(),o(()=>{A(!0),c("hide",i)},e.transitionDuration)}function Q(){g!==void 0&&(g.disconnect(),g=void 0),d!==void 0&&(d(),d=void 0),ae(),R(b,"tooltipTemp")}function k(){We({targetEl:p.value,offset:e.offset,anchorEl:m.value,anchorOrigin:_.value,selfOrigin:x.value,maxHeight:e.maxHeight,maxWidth:e.maxWidth})}function ce(i){if(n.platform.is.mobile===!0){ee(),document.body.classList.add("non-selectable");const M=m.value,h=["touchmove","touchcancel","touchend","click"].map(W=>[M,W,"delayHide","passiveCapture"]);z(b,"tooltipTemp",h)}o(()=>{se(i)},e.delay)}function ue(i){n.platform.is.mobile===!0&&(R(b,"tooltipTemp"),ee(),setTimeout(()=>{document.body.classList.remove("non-selectable")},10)),o(()=>{O(i)},e.hideDelay)}function de(){if(e.noParentEvent===!0||m.value===null)return;const i=n.platform.is.mobile===!0?[[m.value,"touchstart","delayShow","passive"]]:[[m.value,"mouseenter","delayShow","passive"],[m.value,"mouseleave","delayHide","passive"]];z(b,"anchor",i)}function V(){if(m.value!==null||e.scrollTarget!==void 0){S.value=Ce(m.value,e.scrollTarget);const i=e.noParentEvent===!0?k:O;oe(S.value,i)}}function fe(){return y.value===!0?F("div",{...u,ref:p,class:["q-tooltip q-tooltip--style q-position-engine no-pointer-events",u.class],style:[u.style,r.value],role:"tooltip"},xe(s.default)):null}function me(){return F(_e,t.value,fe)}return N(Q),Object.assign(v.proxy,{updatePosition:k}),ne}}),Ne={class:"project-image"},Re=["src","alt"],ze={class:"row full-width items-center"},Fe={class:"col"},Ue={class:"row justify-end q-gutter-xs"},Ge={class:"col-4"},Je={class:"row justify-end"},Ke={class:"project-content"},Ze={class:"project-category"},Xe={class:"project-title"},Ye={class:"project-description"},et=["src","alt"],tt={__name:"WorkCard",props:{project:{type:Object,required:!0,validator:e=>e&&typeof e=="object"&&"id"in e&&"title"in e&&"category"in e&&"description"in e&&"image"in e},isReverse:{type:Boolean,default:!1}},setup(e){const s=Ee(),c=Oe(),u=e,d=B(!1),g=()=>{d.value=!0},v=()=>{d.value=!1},n=async()=>{const o=`${window.location.origin}${window.location.pathname}#/work#project-${u.project.id}`;try{p(o)}catch(t){t.name!=="AbortError"&&(console.error("分享失敗:",t),p(o))}},p=o=>{_("copy",o)},y=async o=>{try{if(navigator.clipboard&&window.isSecureContext)return await navigator.clipboard.writeText(o),!0;throw new Error("複製功能不受支援")}catch(t){return console.error("複製失敗:",t),!1}},_=async(o,t)=>{switch(o){case"copy":{await y(t)?s.notify({type:"positive",message:"連結已複製到剪貼簿！",position:"top",timeout:2e3,icon:"content_copy"}):s.dialog({title:"手動複製連結",message:"請手動複製以下連結：",prompt:{model:t,type:"text",readonly:!0},ok:"關閉",persistent:!0});break}case"facebook":window.open(`https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(t)}`,"_blank","width=600,height=400,scrollbars=yes,resizable=yes"),s.notify({type:"info",message:"正在開啟 Facebook 分享...",position:"top",timeout:2e3,icon:"facebook"});break;case"line":window.open(`https://social-plugins.line.me/lineit/share?url=${encodeURIComponent(t)}`,"_blank","width=600,height=400,scrollbars=yes,resizable=yes"),s.notify({type:"info",message:"正在開啟 LINE 分享...",position:"top",timeout:2e3,icon:"chat"});break;default:s.notify({type:"negative",message:"未知的分享方式",position:"top",timeout:2e3})}},x=o=>{const r=o.currentTarget.querySelector(".project-content");te.to(r,{y:-10,duration:.3})},P=o=>{const r=o.currentTarget.querySelector(".project-content");te.to(r,{y:0,duration:.3})},w=j(()=>!c.isLoggedIn||!c.favorites?!1:c.favorites.includes(u.project.id)),E=async()=>{if(!c.isLoggedIn){s.dialog({title:"需要登入",message:"請先登入帳號才能加入收藏"});return}try{w.value?(await K.favorites({work:u.project.id,action:"remove"}),c.favorites=c.favorites.filter(o=>o!==u.project.id),s.notify({type:"info",message:"已移除收藏",icon:"favorite_border",position:"top",timeout:2e3})):(await K.favorites({work:u.project.id,action:"add"}),c.favorites.push(u.project.id),s.notify({type:"positive",message:"已加入收藏",icon:"favorite",position:"top",timeout:2e3}))}catch(o){console.error("收藏操作失敗:",o),s.notify({type:"negative",message:w.value?"無法移除收藏":"無法加入收藏",position:"top",timeout:2e3})}};return(o,t)=>(D(),U(G,null,[a("div",{class:He(["project-item bg-judy-1",{reverse:e.isReverse}]),onMouseenter:x,onMouseleave:P},[a("div",Ne,[f(J,{class:"my-card",flat:"",bordered:""},{default:l(()=>[a("img",{src:e.project.image,alt:e.project.title,class:"main-image",onClick:g},null,8,Re),f(Me,{align:e.isReverse?"left":"right"},{default:l(()=>[a("div",ze,[a("div",Fe,[a("div",Ue,[(D(!0),U(G,null,qe(e.project.tags,(r,S)=>(D(),De(ge,{square:"",color:`judy-${2+S%5}`,"text-color":"white",icon:"tag",key:r},{default:l(()=>[T(C(r),1)]),_:2},1032,["color"]))),128))])]),a("div",Ge,[a("div",Je,[f(H,{flat:"",round:"",color:"red",icon:w.value?"favorite":"favorite_border",onClick:E},{default:l(()=>[f(I,null,{default:l(()=>t[1]||(t[1]=[T("加入收藏",-1)])),_:1,__:[1]})]),_:1},8,["icon"]),f(H,{flat:"",round:"",color:"teal",icon:"bookmark"},{default:l(()=>[f(I,null,{default:l(()=>t[2]||(t[2]=[T("書籤",-1)])),_:1,__:[2]})]),_:1}),f(H,{flat:"",round:"",color:"primary",icon:"share",onClick:n},{default:l(()=>[f(I,null,{default:l(()=>t[3]||(t[3]=[T("分享作品",-1)])),_:1,__:[3]})]),_:1})])])])]),_:1},8,["align"])]),_:1})]),a("div",Ke,[a("div",Ze,"－"+C(e.project.category),1),a("h3",Xe,C(e.project.title),1),a("p",Ye,C(e.project.description),1),a("button",{class:"project-link",onClick:g},t[4]||(t[4]=[a("span",null,"放大看作品",-1),a("svg",{class:"arrow-icon",viewBox:"0 0 24 24"},[a("path",{d:"M5 12h14M12 5l7 7-7 7"})],-1)]))])],34),f(Ie,{modelValue:d.value,"onUpdate:modelValue":t[0]||(t[0]=r=>d.value=r),maximized:"","transition-show":"none","transition-hide":"none"},{default:l(()=>[f(J,{class:"image-dialog-card bg-black"},{default:l(()=>[a("div",{class:"image-container",onClick:v},[a("img",{src:e.project.image,alt:e.project.title,class:"fullsize-image",onClick:v},null,8,et)])]),_:1})]),_:1},8,["modelValue"])],64))}},lt=$e(tt,[["__scopeId","data-v-fcadb4ea"]]);export{lt as W};
